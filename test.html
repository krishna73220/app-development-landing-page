<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Scrapping Request</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .loader {
            border-top-color: #3498db;
            -webkit-animation: spin 1s linear infinite;
            animation: spin 1s linear infinite;
        }
        @-webkit-keyframes spin {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .file-input-label {
            cursor: pointer;
            border: 2px dashed #cbd5e1;
            padding: 1rem;
            border-radius: 0.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s, border-color 0.2s;
        }
        .file-input-label:hover {
            background-color: #f8fafc;
            border-color: #3b82f6;
        }
        .file-input-label span {
            font-size: 0.875rem;
            color: #4b5563;
        }
        .file-input-label .file-name {
            font-weight: 500;
            color: #1f2937;
            margin-top: 0.5rem;
        }
        .quotation-box {
            background-color: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1.5rem;
        }
        select:disabled {
            background-color: #e5e7eb;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="container mx-auto max-w-3xl px-4 py-8 sm:py-12">
        
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
            <div class="px-6 py-8 sm:p-10">
                <div class="text-center">
                    <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">Vehicle Scrapping Request</h1>
                    <p class="mt-3 text-gray-600">Please fill out the form below to schedule a pickup for your vehicle.</p>
                </div>

                <form id="scrapping-form" class="mt-10">
                    <!-- Contact Information Section -->
                    <div class="space-y-6">
                        <h2 class="text-xl font-semibold text-gray-700 border-b pb-2">Owner's Details</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="customerName" class="block text-sm font-medium text-gray-700">Full Name</label>
                                <input type="text" id="customerName" name="customerName" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                            </div>
                            <div>
                                <label for="contactNumber" class="block text-sm font-medium text-gray-700">Contact Number</label>
                                <input type="tel" id="contactNumber" name="contactNumber" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                            </div>
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700">Email Address</label>
                            <input type="email" id="email" name="email" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        </div>
                    </div>

                    <!-- Vehicle Information Section -->
                    <div class="mt-8 space-y-6">
                        <h2 class="text-xl font-semibold text-gray-700 border-b pb-2">Vehicle Details</h2>
                        <div id="vehicle-dropdowns" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                             <div>
                                <label for="ownershipType" class="block text-sm font-medium text-gray-700">Ownership Type</label>
                                <select id="ownershipType" name="ownershipType" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" onchange="updateQuote()">
                                    <option value="">Select Ownership</option>
                                    <option value="Private">Private</option>
                                    <option value="Commercial">Commercial</option>
                                </select>
                            </div>
                            <div>
                                <label for="registrationType" class="block text-sm font-medium text-gray-700">Registration Type</label>
                                <select id="registrationType" name="registrationType" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                                    <option value="">Select Registration</option>
                                    <option value="Private">Private</option>
                                    <option value="Commercial">Commercial</option>
                                </select>
                            </div>
                             <div>
                                <label for="vehicleCategory" class="block text-sm font-medium text-gray-700">Vehicle Category</label>
                                <select id="vehicleCategory" name="vehicleCategory" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                                    <option value="">Select Category</option>
                                    <option value="4 Wheeler">4 Wheeler</option>
                                    <option value="2 Wheeler">2 Wheeler</option>
                                    <option value="3 Wheeler">3 Wheeler</option>
                                    <option value="Commercial Vehicle">Commercial Vehicle</option>
                                </select>
                            </div>
                             <div>
                                <label for="vehicleBrand" class="block text-sm font-medium text-gray-700">Brand</label>
                                <select id="vehicleBrand" name="vehicleBrand" required class="mt-1 block w-full px-4 py-2 bg-gray-200 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" disabled>
                                    <option value="">Select Category First</option>
                                </select>
                            </div>
                            <div>
                                <label for="vehicleModel" class="block text-sm font-medium text-gray-700">Model</label>
                                <select id="vehicleModel" name="vehicleModel" required class="mt-1 block w-full px-4 py-2 bg-gray-200 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" disabled>
                                    <option value="">Select Brand First</option>
                                </select>
                            </div>
                            <div>
                                <label for="registrationNumber" class="block text-sm font-medium text-gray-700">Registration Number</label>
                                <input type="text" id="registrationNumber" name="registrationNumber" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                            </div>
                        </div>
                        
                        <!-- Manual Entry Section -->
                        <div class="mt-6 pt-4 border-t border-dashed">
                             <label for="manualEntryCheckbox" class="flex items-center">
                                <input type="checkbox" id="manualEntryCheckbox" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <span class="ml-3 text-sm text-gray-700">My vehicle is not in the list. Continue by entering details manually.</span>
                            </label>
                            <div id="manualEntryFields" class="hidden mt-4 space-y-4">
                                <div>
                                    <label for="manualVehicleEntry" class="block text-sm font-medium text-gray-700">Brand & Model (e.g., Maruti Suzuki Zen 1998)</label>
                                    <input type="text" id="manualVehicleEntry" name="manualVehicleEntry" class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quotation Section -->
                    <div id="quotation-section" class="mt-8 space-y-6">
                        <h2 class="text-xl font-semibold text-gray-700 border-b pb-2">Your Tentative Quotation</h2>
                        <div id="quotation-result" class="quotation-box">
                             <div id="quote-placeholder" class="text-center text-gray-500">
                                Please select a vehicle model to see your quote.
                            </div>
                            <div id="quote-details" class="hidden">
                                <dl class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <dt class="text-gray-600">Base Scrap Value:</dt>
                                        <dd id="scrap-value-display" class="font-semibold text-gray-900"></dd>
                                    </div>
                                    <div id="cod-buyback-row" class="flex items-center justify-between hidden">
                                        <dt class="text-gray-600">COD Buyback Bonus:</dt>
                                        <dd id="cod-buyback-display" class="font-semibold text-green-600"></dd>
                                    </div>
                                    <div class="border-t pt-4 mt-4 flex items-center justify-between">
                                        <dt class="text-xl font-bold text-gray-900">Total Tentative Quote:</dt>
                                        <dd id="total-quote-display" class="text-xl font-bold text-blue-600"></dd>
                                    </div>
                                </dl>
                                <div id="cod-buyback-option" class="mt-6 hidden">
                                    <label for="codBuyback" class="flex items-center">
                                        <input type="checkbox" id="codBuyback" name="codBuyback" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                        <span class="ml-3 text-sm text-gray-700">Yes, I want to add the COD Buyback for ₹12,000.</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <!-- Hidden fields to store quote data for submission -->
                        <input type="hidden" id="kerbWeight" name="kerbWeight">
                        <input type="hidden" id="scrapValue" name="scrapValue">
                        <input type="hidden" id="codBuybackValue" name="codBuybackValue">
                        <input type="hidden" id="totalQuote" name="totalQuote">
                    </div>

                    <!-- Document Upload Section -->
                    <div class="mt-8 space-y-6">
                        <h2 class="text-xl font-semibold text-gray-700 border-b pb-2">Required Documents</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label for="rcPhoto" class="block text-sm font-medium text-gray-700 mb-1">RC Photo</label><label class="file-input-label"><input type="file" id="rcPhoto" name="rcPhoto" required class="hidden" accept="image/*,.pdf" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                            <div><label for="aadhaarFront" class="block text-sm font-medium text-gray-700 mb-1">Aadhaar Card (Front)</label><label class="file-input-label"><input type="file" id="aadhaarFront" name="aadhaarFront" required class="hidden" accept="image/*,.pdf" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                            <div><label for="aadhaarBack" class="block text-sm font-medium text-gray-700 mb-1">Aadhaar Card (Back)</label><label class="file-input-label"><input type="file" id="aadhaarBack" name="aadhaarBack" required class="hidden" accept="image/*,.pdf" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                            <div><label for="bankDetails" class="block text-sm font-medium text-gray-700 mb-1">Bank Details (Cancelled Cheque)</label><label class="file-input-label"><input type="file" id="bankDetails" name="bankDetails" required class="hidden" accept="image/*,.pdf" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                        </div>
                    </div>

                    <!-- Vehicle Photos Section -->
                    <div class="mt-8 space-y-6">
                        <h2 class="text-xl font-semibold text-gray-700 border-b pb-2">Vehicle Photos</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div><label for="photoFront" class="block text-sm font-medium text-gray-700 mb-1">Front</label><label class="file-input-label"><input type="file" id="photoFront" name="photoFront" required class="hidden" accept="image/*" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                            <div><label for="photoBack" class="block text-sm font-medium text-gray-700 mb-1">Back</label><label class="file-input-label"><input type="file" id="photoBack" name="photoBack" required class="hidden" accept="image/*" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                            <div><label for="photoLeftSide" class="block text-sm font-medium text-gray-700 mb-1">Left Side</label><label class="file-input-label"><input type="file" id="photoLeftSide" name="photoLeftSide" required class="hidden" accept="image/*" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                            <div><label for="photoRightSide" class="block text-sm font-medium text-gray-700 mb-1">Right Side</label><label class="file-input-label"><input type="file" id="photoRightSide" name="photoRightSide" required class="hidden" accept="image/*" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                            <div><label for="photoInterior" class="block text-sm font-medium text-gray-700 mb-1">Interior</label><label class="file-input-label"><input type="file" id="photoInterior" name="photoInterior" required class="hidden" accept="image/*" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                            <div><label for="photoUnderHood" class="block text-sm font-medium text-gray-700 mb-1">Under the Hood</label><label class="file-input-label"><input type="file" id="photoUnderHood" name="photoUnderHood" required class="hidden" accept="image/*" onchange="updateFileName(this)"><span>Click to upload</span><span class="file-name">No file selected</span></label></div>
                        </div>
                    </div>

                    <!-- Pickup Information Section -->
                    <div class="mt-8 space-y-6">
                        <h2 class="text-xl font-semibold text-gray-700 border-b pb-2">Pickup Details</h2>
                        <div><label for="pickupAddress" class="block text-sm font-medium text-gray-700">Full Pickup Address</label><textarea id="pickupAddress" name="pickupAddress" rows="3" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"></textarea></div>
                        <div><label for="pickupDate" class="block text-sm font-medium text-gray-700">Preferred Pickup Date</label><input type="date" id="pickupDate" name="pickupDate" required class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"></div>
                        <div><label for="comments" class="block text-sm font-medium text-gray-700">Additional Comments</label><textarea id="comments" name="comments" rows="3" class="mt-1 block w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"></textarea></div>
                    </div>

                    <!-- Submission Button -->
                    <div class="mt-10 text-center">
                        <button type="submit" id="submit-button" class="inline-flex items-center justify-center w-full sm:w-auto px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-300 ease-in-out">
                            <span id="button-text">Submit Request</span>
                            <div id="button-loader" class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-6 w-6 ml-3 hidden"></div>
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Success/Error Message Modal -->
        <div id="message-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50 p-4">
            <div class="bg-white rounded-lg shadow-xl p-8 max-w-sm mx-auto text-center">
                <div id="modal-icon"></div>
                <h3 id="modal-title" class="text-2xl font-bold mt-4"></h3>
                <p id="modal-body" class="text-gray-600 mt-2"></p>
                <button onclick="closeModal()" class="mt-6 w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">Close</button>
            </div>
        </div>
    </div>

    <script>
        // --- VEHICLE DATA (EXPANDED LIST - V2) ---
        const vehicleData = {
            "4 Wheeler": {
                "Maruti Suzuki": [{model:"800",weight:650},{model:"1000",weight:840},{model:"Alto",weight:725},{model:"Baleno (Old)",weight:985},{model:"Baleno",weight:940},{model:"Brezza",weight:1150},{model:"Ciaz",weight:1020},{model:"Dzire",weight:920},{model:"Eeco",weight:940},{model:"Ertiga",weight:1170},{model:"Esteem",weight:875},{model:"Fronx",weight:1000},{model:"Grand Vitara (Old)",weight:1500},{model:"Grand Vitara",weight:1200},{model:"Gypsy",weight:985},{model:"Ignis",weight:850},{model:"Jimny",weight:1100},{model:"Omni",weight:785},{model:"Ritz",weight:1030},{model:"S-Cross",weight:1130},{model:"Swift",weight:900},{model:"SX4",weight:1200},{model:"Wagon R",weight:850},{model:"XL6",weight:1180},{model:"Zen",weight:765},{model:"Zen Estilo",weight:860}],
                "Hyundai": [{model:"Accent",weight:1020},{model:"Aura",weight:950},{model:"Creta",weight:1300},{model:"Elantra",weight:1250},{model:"Eon",weight:760},{model:"Exter",weight:1000},{model:"Getz",weight:995},{model:"i10",weight:930},{model:"i20",weight:1050},{model:"Santro",weight:850},{model:"Sonata",weight:1450},{model:"Tucson",weight:1500},{model:"Venue",weight:1150},{model:"Verna",weight:1100}],
                "Tata Motors": [{model:"Altroz",weight:1036},{model:"Harrier",weight:1680},{model:"Indica",weight:995},{model:"Indigo",weight:1050},{model:"Nano",weight:635},{model:"Nexon",weight:1250},{model:"Punch",weight:1000},{model:"Safari (Old - Dicor)",weight:1920},{model:"Safari",weight:1825},{model:"Sierra",weight:1410},{model:"Sumo",weight:1820},{model:"Tiago",weight:980},{model:"Tigor",weight:1000},{model:"Zest",weight:1115},{model:"Estate",weight:1260}],
                "Mahindra": [{model:"Armada",weight:1550},{model:"Bolero",weight:1620},{model:"Commander",weight:1500},{model:"KUV100",weight:1100},{model:"Marazzo",weight:1650},{model:"Quanto",weight:1640},{model:"Scorpio",weight:1850},{model:"Thar",weight:1750},{model:"Verito",weight:1140},{model:"XUV300",weight:1300},{model:"XUV500",weight:1785},{model:"XUV700",weight:1960}],
                "Honda": [{model:"Accord",weight:1500},{model:"Amaze",weight:950},{model:"Brio",weight:920},{model:"City (1st Gen)",weight:985},{model:"City",weight:1150},{model:"Civic",weight:1300},{model:"CR-V",weight:1550},{model:"Jazz",weight:1050},{model:"Mobilio",weight:1160},{model:"WR-V",weight:1100}],
                "Toyota": [{model:"Camry",weight:1665},{model:"Corolla",weight:1140},{model:"Etios",weight:930},{model:"Fortuner",weight:2180},{model:"Glanza",weight:940},{model:"Hilux",weight:2100},{model:"Innova",weight:1650},{model:"Innova Crysta",weight:1730},{model:"Qualis",weight:1430},{model:"Urban Cruiser",weight:1130}],
                "Ford": [{model:"Aspire",weight:1020},{model:"EcoSport",weight:1250},{model:"Endeavour",weight:2300},{model:"Escort",weight:1080},{model:"Fiesta",weight:1150},{model:"Figo",weight:1040},{model:"Fusion",weight:1100},{model:"Ikon",weight:980}],
                "Volkswagen": [{model:"Ameo",weight:1100},{model:"Jetta",weight:1370},{model:"Passat",weight:1550},{model:"Polo",weight:1050},{model:"Taigun",weight:1250},{model:"Tiguan",weight:1600},{model:"Vento",weight:1150},{model:"Virtus",weight:1200}],
                "Skoda": [{model:"Fabia",weight:1080},{model:"Kushaq",weight:1250},{model:"Laura",weight:1400},{model:"Octavia",weight:1400},{model:"Rapid",weight:1150},{model:"Slavia",weight:1200},{model:"Superb",weight:1550},{model:"Yeti",weight:1520}],
                "Hindustan Motors": [{model:"Ambassador",weight:1100},{model:"Contessa",weight:1150}],
                "Premier": [{model:"Padmini",weight:895},{model:"118NE",weight:960}],
                "Standard": [{model:"Herald",weight:770},{model:"Gazel",weight:850}],
                "Fiat": [{model:"Uno",weight:895},{model:"Palio",weight:1000},{model:"Siena",weight:1010},{model:"Linea",weight:1200},{model:"Punto",weight:1150}],
                "Nissan": [{model:"Micra",weight:970},{model:"Sunny",weight:1030},{model:"Terrano",weight:1300},{model:"Kicks",weight:1350},{model:"Magnite",weight:1000}],
                "Renault": [{model:"Duster",weight:1300},{model:"Kwid",weight:700},{model:"Lodgy",weight:1350},{model:"Triber",weight:950},{model:"Kiger",weight:1012}],
                "Chevrolet": [{model:"Spark",weight:840},{model:"Beat",weight:980},{model:"Sail",weight:1080},{model:"Cruze",weight:1520},{model:"Tavera",weight:1600},{model:"Optra",weight:1255}],
                "Daewoo": [{model:"Matiz",weight:800},{model:"Cielo",weight:1000}],
                "Opel": [{model:"Astra",weight:1100},{model:"Corsa",weight:980}],
                "Mitsubishi": [{model:"Lancer",weight:1100},{model:"Pajero",weight:2100}],
                "Kia": [{model:"Seltos",weight:1350},{model:"Sonet",weight:1150},{model:"Carnival",weight:2100},{model:"Carens",weight:1400}],
                "Mercedes-Benz": [{model:"C-Class",weight:1550},{model:"E-Class",weight:1700},{model:"S-Class",weight:2000},{model:"GLA",weight:1500},{model:"GLC",weight:1800},{model:"GLE",weight:2200},{model:"GLS",weight:2400}],
                "BMW": [{model:"3 Series",weight:1600},{model:"5 Series",weight:1750},{model:"7 Series",weight:2000},{model:"X1",weight:1600},{model:"X3",weight:1850},{model:"X5",weight:2200}],
                "Audi": [{model:"A4",weight:1600},{model:"A6",weight:1750},{model:"Q3",weight:1650},{model:"Q5",weight:1850},{model:"Q7",weight:2200}]
            },
            "2 Wheeler": {
                "Hero / Hero Honda": [{model:"Splendor",weight:112},{model:"Passion",weight:118},{model:"Glamour",weight:123},{model:"CBZ",weight:138},{model:"Karizma",weight:150},{model:"CD 100",weight:100},{model:"Sleek",weight:105}],
                "Honda": [{model:"Activa",weight:107},{model:"Dio",weight:105},{model:"Shine",weight:115},{model:"Unicorn",weight:140},{model:"Kinetic",weight:90}],
                "TVS": [{model:"Apache",weight:145},{model:"Jupiter",weight:109},{model:"Victor",weight:113},{model:"Scooty",weight:95}],
                "Bajaj": [{model:"Pulsar",weight:150},{model:"Discover",weight:125},{model:"Platina",weight:117},{model:"Avenger",weight:163},{model:"Chetak",weight:103},{model:"Super",weight:100}],
                "Royal Enfield": [{model:"Bullet 350",weight:191},{model:"Classic 350",weight:195},{model:"Himalayan",weight:199},{model:"Interceptor 650",weight:202}],
                "Yamaha": [{model:"RX100",weight:103},{model:"RD350",weight:155},{model:"FZ",weight:137},{model:"R15",weight:142}],
                "Suzuki": [{model:"Access 125",weight:104},{model:"Gixxer",weight:141},{model:"Shogun",weight:114},{model:"Samurai",weight:110}],
                "Jawa / Yezdi": [{model:"Jawa 250",weight:140},{model:"Yezdi Roadking",weight:145}],
                "LML": [{model:"Vespa",weight:100}],
                "Rajdoot": [{model:"GTS (Bobby)",weight:95},{model:"175",weight:120}]
            },
            "3 Wheeler": {
                "Bajaj": [{model:"RE",weight:350}],
                "Piaggio": [{model:"Ape",weight:360}],
                "Mahindra": [{model:"Alfa",weight:400}],
                "Tempo": [{model:"Hanseat",weight:450}]
            },
            "Commercial Vehicle": {
                "Tata Motors": [{model:"Ace",weight:850},{model:"407",weight:2250}],
                "Ashok Leyland": [{model:"Dost",weight:1250},{model:"Comet",weight:3500}],
                "Mahindra": [{model:"Jeeto",weight:700},{model:"Bolero Pik-Up",weight:1700}],
                "Force Motors": [{model:"Tempo Matador",weight:1500},{model:"Traveller",weight:2800}],
                "Eicher": [{model:"Canter / 10.59",weight:3300}],
                "Swaraj Mazda": [{model:"T-Series",weight:3500}],
                "Bedford": [{model:"J4/J5",weight:3000}]
            }
        };

        // --- FORM ELEMENTS ---
        const form = document.getElementById('scrapping-form');
        const submitButton = document.getElementById('submit-button');
        const buttonText = document.getElementById('button-text');
        const buttonLoader = document.getElementById('button-loader');
        const modal = document.getElementById('message-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        const modalIcon = document.getElementById('modal-icon');

        // Vehicle Dropdowns & Manual Entry
        const categorySelect = document.getElementById('vehicleCategory');
        const brandSelect = document.getElementById('vehicleBrand');
        const modelSelect = document.getElementById('vehicleModel');
        const manualEntryCheckbox = document.getElementById('manualEntryCheckbox');
        const manualEntryFields = document.getElementById('manualEntryFields');
        const manualVehicleInput = document.getElementById('manualVehicleEntry');
        const quotationSection = document.getElementById('quotation-section');
        const vehicleDropdownsDiv = document.getElementById('vehicle-dropdowns');

        // Quotation Elements
        const quotePlaceholder = document.getElementById('quote-placeholder');
        const quoteDetails = document.getElementById('quote-details');
        const scrapValueDisplay = document.getElementById('scrap-value-display');
        const totalQuoteDisplay = document.getElementById('total-quote-display');
        const codBuybackOptionDiv = document.getElementById('cod-buyback-option');
        const codBuybackCheckbox = document.getElementById('codBuyback');
        const codBuybackRow = document.getElementById('cod-buyback-row');
        const codBuybackDisplay = document.getElementById('cod-buyback-display');
        
        // Hidden Inputs
        const kerbWeightInput = document.getElementById('kerbWeight');
        const scrapValueInput = document.getElementById('scrapValue');
        const codBuybackValueInput = document.getElementById('codBuybackValue');
        const totalQuoteInput = document.getElementById('totalQuote');
        
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyn9Y-7KFOf32-c_qk7EnYZoagjsfbT61LmtS2QwQv29FfPDyk6UdCq6VXLf_y6biZB3A/exec';
        const COD_BUYBACK_AMOUNT = 12000;
        let currentScrapValue = 0;

        // --- EVENT LISTENERS ---
        manualEntryCheckbox.addEventListener('change', () => {
            const isChecked = manualEntryCheckbox.checked;
            
            quotationSection.classList.toggle('hidden', isChecked);
            manualEntryFields.classList.toggle('hidden', !isChecked);
            
            manualVehicleInput.required = isChecked;
            brandSelect.required = !isChecked;
            modelSelect.required = !isChecked;

            document.querySelectorAll('#vehicle-dropdowns select').forEach(el => {
                if(el.id !== 'ownershipType' && el.id !== 'registrationType') {
                    el.disabled = isChecked;
                }
            });

            if (isChecked) {
                categorySelect.value = '';
                brandSelect.innerHTML = '<option value="">Select Category First</option>';
                modelSelect.innerHTML = '<option value="">Select Brand First</option>';
                brandSelect.disabled = true;
                modelSelect.disabled = true;
                resetQuote();
            } else {
                categorySelect.disabled = false;
            }
        });
        
        categorySelect.addEventListener('change', () => {
            const category = categorySelect.value;
            brandSelect.innerHTML = '<option value="">Select Brand</option>';
            modelSelect.innerHTML = '<option value="">Select Brand First</option>';
            brandSelect.disabled = true;
            modelSelect.disabled = true;
            resetQuote();

            if (category && vehicleData[category]) {
                const brands = Object.keys(vehicleData[category]);
                brands.sort().forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand;
                    option.textContent = brand;
                    brandSelect.appendChild(option);
                });
                brandSelect.disabled = false;
            }
        });

        brandSelect.addEventListener('change', () => {
            const category = categorySelect.value;
            const brand = brandSelect.value;
            modelSelect.innerHTML = '<option value="">Select Model</option>';
            modelSelect.disabled = true;
            resetQuote();

            if (category && brand && vehicleData[category][brand]) {
                const models = vehicleData[category][brand];
                models.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.model;
                    option.textContent = item.model;
                    option.dataset.weight = item.weight;
                    modelSelect.appendChild(option);
                });
                modelSelect.disabled = false;
            }
        });

        modelSelect.addEventListener('change', updateQuote);
        codBuybackCheckbox.addEventListener('change', updateQuote);
        document.getElementById('ownershipType').addEventListener('change', updateQuote);

        function updateQuote() {
            const selectedModelOption = modelSelect.options[modelSelect.selectedIndex];
            const weight = selectedModelOption.dataset.weight;

            if (weight) {
                const kerbWeight = parseFloat(weight);
                currentScrapValue = Math.round(kerbWeight * 22);
                
                kerbWeightInput.value = kerbWeight;
                scrapValueInput.value = currentScrapValue;
                scrapValueDisplay.textContent = `₹${currentScrapValue.toLocaleString('en-IN')}`;

                let total = currentScrapValue;
                let codValue = 0;

                const isEligibleForCOD = document.getElementById('ownershipType').value === 'Private' && categorySelect.value === '4 Wheeler';
                codBuybackOptionDiv.classList.toggle('hidden', !isEligibleForCOD);
                
                if (isEligibleForCOD && codBuybackCheckbox.checked) {
                    total += COD_BUYBACK_AMOUNT;
                    codValue = COD_BUYBACK_AMOUNT;
                    codBuybackRow.classList.remove('hidden');
                    codBuybackDisplay.textContent = `+ ₹${COD_BUYBACK_AMOUNT.toLocaleString('en-IN')}`;
                } else {
                    codBuybackRow.classList.add('hidden');
                }

                totalQuoteDisplay.textContent = `₹${total.toLocaleString('en-IN')}`;
                codBuybackValueInput.value = codValue;
                totalQuoteInput.value = total;

                quotePlaceholder.classList.add('hidden');
                quoteDetails.classList.remove('hidden');
            } else {
                resetQuote();
            }
        }
        
        function resetQuote() {
            quotePlaceholder.classList.remove('hidden');
            quoteDetails.classList.add('hidden');
            kerbWeightInput.value = '';
            scrapValueInput.value = '';
            codBuybackValueInput.value = '';
            totalQuoteInput.value = '';
            currentScrapValue = 0;
        }


        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const isManualEntry = manualEntryCheckbox.checked;
            if (!isManualEntry && (!totalQuoteInput.value || totalQuoteInput.value === '0')) {
                showModal('Quotation Required', 'Please select a vehicle to generate a quote before submitting.', 'error');
                return;
            }

            submitButton.disabled = true;
            buttonText.classList.add('hidden');
            buttonLoader.classList.remove('hidden');

            const formData = new FormData(form);
            
            fetch(SCRIPT_URL, { method: 'POST', body: formData })
            .then(res => res.json())
            .then(data => {
                if (data.result === 'success') {
                    showModal('Success!', 'Your request has been submitted successfully.', 'success');
                    form.reset();
                    document.querySelectorAll('.file-name').forEach(span => span.textContent = 'No file selected');
                    document.querySelectorAll('.file-input-label').forEach(label => label.classList.remove('border-blue-500'));
                    resetQuote();
                    brandSelect.innerHTML = '<option value="">Select Category First</option>';
                    modelSelect.innerHTML = '<option value="">Select Brand First</option>';
                    brandSelect.disabled = true;
                    modelSelect.disabled = true;
                    manualEntryCheckbox.checked = false;
                    manualEntryCheckbox.dispatchEvent(new Event('change'));
                } else {
                    throw new Error(data.message || 'An unknown error occurred.');
                }
            })
            .catch(error => {
                console.error('Error!', error.message);
                showModal('Submission Failed', 'There was a problem submitting your request. Details: ' + error.message, 'error');
            })
            .finally(() => {
                submitButton.disabled = false;
                buttonText.classList.remove('hidden');
                buttonLoader.classList.add('hidden');
            });
        });

        // --- UTILITY FUNCTIONS ---
        function updateFileName(inputElement) {
            const label = inputElement.closest('.file-input-label');
            const fileNameSpan = label.querySelector('.file-name');
            if (inputElement.files.length > 0) {
                fileNameSpan.textContent = inputElement.files[0].name;
                label.classList.add('border-blue-500');
            } else {
                fileNameSpan.textContent = 'No file selected';
                label.classList.remove('border-blue-500');
            }
        }
        
        function showModal(title, body, type) {
            modalTitle.textContent = title;
            modalBody.textContent = body;
            
            if (type === 'success') {
                modalIcon.innerHTML = `<svg class="w-16 h-16 mx-auto text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`;
            } else {
                modalIcon.innerHTML = `<svg class="w-16 h-16 mx-auto text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`;
            }
            modal.classList.remove('hidden');
        }

        function closeModal() {
            modal.classList.add('hidden');
        }
        
        document.getElementById('pickupDate').min = new Date().toISOString().split("T")[0];

    </script>
</body>
</html>
